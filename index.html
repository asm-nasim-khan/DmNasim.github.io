<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Message</title>
  <link rel="stylesheet" href="./style.css">
</head>
<body>
<!-- partial:index.partial.html -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4" crossorigin="anonymous"></script>

<div class="bg"></div>

<main class="form-signin">
  <h1 class="h3">Message For Nasim</h1>
  <form id="messageForm">
    <div class="form-floating">
      <input type="text" class="form-control" id="floatingInput" >
      <label for="floatingInput">Send Something</label>
    </div>
    <button class="w-100 btn btn-lg" type="submit">Submit</button>
  </form>
  <p class="copyright">&copy; 2024</p>
</main>

<!-- Include Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-firestore.js"></script>

<!-- Initialize Firebase -->
<script>
  // Your web app's Firebase configuration
  const firebaseConfig = {
  apiKey: "AIzaSyBgAqSc6L5zbrzfWR781JJbWKNofOZQk10",
  authDomain: "msgrepo-5fa79.firebaseapp.com",
  databaseURL: "https://msgrepo-5fa79-default-rtdb.firebaseio.com",
  projectId: "msgrepo-5fa79",
  storageBucket: "msgrepo-5fa79.appspot.com",
  messagingSenderId: "281846830546",
  appId: "1:281846830546:web:9563e1a1b3ffcbb05b640b",
  measurementId: "G-F9SHR3JHXQ"
  };

  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);

  // Get a reference to the Firestore service
  const firestore = firebase.firestore();

  // Reference to the message collection
  const messagesCollection = firestore.collection('messages');

  // Form submission handler
  document.getElementById('messageForm').addEventListener('submit', function(event) {
    event.preventDefault(); // Prevent the default form submission

    // Get the email input value
    const email = document.getElementById('floatingInput').value;

    // Add a new message document to Firestore
    messagesCollection.add({
      email: email,
      timestamp: firebase.firestore.FieldValue.serverTimestamp()
    })
    .then(function(docRef) {
      console.log('Document written with ID: ', docRef.id);
      alert('Message sent successfully!');
      document.getElementById('messageForm').reset(); // Reset the form after submission
    })
    .catch(function(error) {
      console.error('Error adding document: ', error);
      alert('An error occurred while sending the message. Please try again later.');
    });
  });
</script>
</body>
</html>
